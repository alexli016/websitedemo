<!--Start of external scripts-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.2/TweenMax.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/ScrollMagic.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/animation.gsap.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/debug.addIndicators.js"></script>
<!--End of external scripts-->

<!-- Steyle Sheet -->
<link rel="stylesheet" type="text/css" href="css/style.css">

<!--START OF VIDEO LAYER-->
<div id="triggerTop"></div>
<div class="videoLayer-mayo">
    <video id="bgVideo-mayo" preload="auto" playsinline="true">
        <source id="MayoDeVideo" src="videos/MayoDe.mp4" type="video/mp4" media="(min-width: 1200px)">
        <source id="MayoMoVideo" src="videos/MayoMo.mp4" type="video/mp4">
    </video>
</div>
<!--END OF VIDEO LAYER-->

<!--START OF TEXT LAYER -->
<div class="text-box-container">
    <p class="text-box" id="overlay-text-mayo">This is New Mayo Clinic Outpatient Enrtance. <br> Six-story patient tower
        featuring new patient rooms, <br>clinical and rehab space and an outpatient surgical center
    </p>
    <p class="text-box" id="overlay-text-mayo-02">This is New Mayo Clinic Emergency Enrtance <br> Three-story building
        to house expanded Emergency Department, <br>Laboratory Medicine, Radiology and Pharmacy</p>
    <p class="text-box" id="overlay-text-mayo-03">
        Mayo Clinic Building will grow from three to seven stories for current and future clinical services
    </p>
</div>
<!--END OF TEXT LAYER -->

<script>
    const videoLayerMayo = document.querySelector('.videoLayer-mayo');
    const videoMayo = videoLayerMayo.querySelector('video');

    // init controller
    let controller = new ScrollMagic.Controller();

    // build video scene
    let scene = new ScrollMagic.Scene({
        triggerElement: videoLayerMayo,
        triggerHook: 0,
        offset: 0,
        duration: 13000
    })
        // .addIndicators({ name: "--- videoPlayer" })
        .setPin(videoLayerMayo)
        .addTo(controller);

    //Creating Video Animation
    let accelamount = 0.2;
    // to decrease delay effect, increase the number
    let scrollpos = 0;
    let delay = 0;
    let frameRate = 30;

    scene.on('update', e => {
        scrollpos = e.scrollPos / 1000;
        //video.currentTime = e.scrollPos * (video duration/duration)
        console.log("e.scrollPos / 1000 =" + e.scrollPos / 1000);
        console.log("scrollPos =" + e.scrollPos);
        //e.scrollPos comes from Scroll Magic and it is connect with the duration
    });

    setInterval(() => {
        delay += (scrollpos - delay) * accelamount;
        console.log(scrollpos, delay);

        videoMayo.currentTime = delay;
        console.log('video current time =' + videoMayo.currentTime);
    }, 1000 / frameRate);

    // textLayer.overlayText01 pin and scroll up
    let scene3 = new ScrollMagic.Scene({
        duration: 5000,
        triggerElement: "#overlay-text-mayo",
        triggerHook: 1,
    })
        //.addIndicators({ name: "--- Mayo Layer" })
        .setPin('#overlay-text-mayo')
        .addTo(controller);

    let scene4 = new ScrollMagic.Scene({
        offset: 5000,
        duration: 1200,
        triggerElement: "#overlay-text-mayo",
        triggerHook: 0.6,
    })
        //.addIndicators({ name: "--- scene 5 Wexford Layer" })
        .setPin('#overlay-text-mayo')
        .addTo(controller);

    // textLayer.overlayText02 pin and scroll up
    let scene5 = new ScrollMagic.Scene({
        duration: 7300,
        triggerElement: "#overlay-text-mayo-02",
        triggerHook: 1,
    })
        //.addIndicators({ name: "--- overlay-text-02" })
        .setPin('#overlay-text-mayo-02')
        .addTo(controller);

    let scene6 = new ScrollMagic.Scene({
        offset: 7300,
        duration: 1200,
        triggerElement: "#overlay-text-mayo-02",
        triggerHook: 0.6,
    })
        //.addIndicators({ name: "--- overlay-text-wexford-02" })
        .setPin('#overlay-text-mayo-02')
        .addTo(controller);

    //textLayer.overlayText03 pin and scroll up
    let scene7 = new ScrollMagic.Scene({
        duration: 9700,
        triggerElement: "#overlay-text-mayo-03",
        triggerHook: 1,
    })
        //.addIndicators({ name: "--- overlay-text-02" })
        .setPin('#overlay-text-mayo-03')
        .addTo(controller);

    let scene8 = new ScrollMagic.Scene({
        offset: 9700,
        duration: 2000,
        triggerElement: "#overlay-text-mayo-03",
        triggerHook: 0.6,
    })
        //.addIndicators({ name: "--- overlay-text-wexford-02" })
        .setPin('#overlay-text-mayo-03')
        .addTo(controller);
</script>