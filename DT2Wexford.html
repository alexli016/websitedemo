<!--Start of external scripts-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.2/TweenMax.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/ScrollMagic.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/animation.gsap.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/debug.addIndicators.js"></script>
<!--End of external scripts-->

<!--START OF VIDEO LAYER-->
<div id="triggerTop"></div>
<div class="videoLayer-wexford">
    <video id="bgVideo-wexford" type="video/mp4" preload="auto" playsinline="true">
        <source src="videos/WexfordDe.mp4" type="video/mp4" media="(min-width: 1200px)">
        <source id="MayoMoVideo" type="video/mp4" src="videos/WexfordMo.mp4">
    </video>
</div>
<!--END OF VIDEO LAYER-->

<!--START OF TEXT LAYER -->
<div class="text-box-container">
    <p class="text-box" id="overlay-text-wexford">This is Wexford Science Building, <br>located at 850 N 5th Street. <br>It has 7 floors and 227,113 total rentable square feet.</p>
    <p class="text-box" id="overlay-text-wexford-02">LabForce and
        Validation Lab will be located on the first floor</p>
    <p class="text-box" id="overlay-text-wexford-03">Part of floor 1 to floor 4 will be occupied by Arizona State University</p>
    <p class="text-box" id="overlay-text-wexford-04">Floor 5 to floor 7 will be fully lab enabled</p>
</div>
<!--END OF TEXT LAYER -->

<!-- Steyle Sheet -->
<link rel="stylesheet" type="text/css" href="css/style.css">

<script>
    const videoLayerWexford = document.querySelector('.videoLayer-wexford');
    const videoWexford = videoLayerWexford.querySelector('video');

    // init controller
    let controller = new ScrollMagic.Controller();

    // build video scene
    let scene = new ScrollMagic.Scene({
        triggerElement: videoLayerWexford,
        triggerHook: 0,
        offset: 0,
        duration: 9000
    })
        // .addIndicators({ name: "--- videoPlayer" })
        .setPin(videoLayerWexford)
        .addTo(controller);

    //Creating Video Animation
    let accelamount = 0.2;
    // to decrease delay effect, increase the number
    let scrollpos = 0;
    let delay = 0;
    let frameRate = 30;

    scene.on('update', e => {
        scrollpos = e.scrollPos / 1000;
        //video.currentTime = e.scrollPos * (video duration/duration)
        console.log("e.scrollPos / 1000 =" + e.scrollPos / 1000);
        console.log("scrollPos =" + e.scrollPos);
        //e.scrollPos comes from Scroll Magic and it is connect with the duration
    });

    setInterval(() => {
        delay += (scrollpos - delay) * accelamount;
        console.log(scrollpos, delay);

        videoWexford.currentTime = delay;
        console.log('video current time =' + videoWexford.currentTime);
    }, 1000 / frameRate);
    // video.currentTime indicates the position for the playback of the video, in seconds

    // textLayer.overlayText01 pin and scroll up
    let scene3 = new ScrollMagic.Scene({
        duration: 2700,
        triggerElement: "#overlay-text-wexford",
        triggerHook: 1,
    })
        // .addIndicators({ name: "--- Wexford Layer" })
        .setPin('#overlay-text-wexford')
        .addTo(controller);

    let scene4 = new ScrollMagic.Scene({
        offset: 2700,
        duration: 1000,
        triggerElement: "#overlay-text-wexford",
        triggerHook: 0.4,
    })
        //.addIndicators({ name: "--- scene 5 Wexford Layer" })
        .setPin('#overlay-text-wexford')
        .addTo(controller);

    // textLayer.overlayText02 pin and scroll up
    let scene5 = new ScrollMagic.Scene({
        duration: 5000,
        triggerElement: "#overlay-text-wexford-02",
        triggerHook: 1,
    })
        //.addIndicators({ name: "--- overlay-text-02" })
        .setPin('#overlay-text-wexford-02')
        .addTo(controller);

    let scene6 = new ScrollMagic.Scene({
        offset: 5000,
        duration: 1200,
        triggerElement: "#overlay-text-wexford-02",
        triggerHook: 0.6,
    })
        //.addIndicators({ name: "--- overlay-text-wexford-02" })
        .setPin('#overlay-text-wexford-02')
        .addTo(controller);

    // textLayer.overlayText03 pin and scroll up
    let scene7 = new ScrollMagic.Scene({
        duration: 6500,
        triggerElement: "#overlay-text-wexford-03",
        triggerHook: 1,
    })
        //.addIndicators({ name: "--- overlay-text-02" })
        .setPin('#overlay-text-wexford-03')
        .addTo(controller);

    let scene8 = new ScrollMagic.Scene({
        offset: 6500,
        duration: 1000,
        triggerElement: "#overlay-text-wexford-03",
        triggerHook: 0.6,
    })
        //.addIndicators({ name: "--- overlay-text-wexford-02" })
        .setPin('#overlay-text-wexford-03')
        .addTo(controller);

    // textLayer.overlayText03 pin and scroll up
    let scene9 = new ScrollMagic.Scene({
        duration: 8000,
        triggerElement: "#overlay-text-wexford-04",
        triggerHook: 1,
    })
        //.addIndicators({ name: "--- overlay-text-02" })
        .setPin('#overlay-text-wexford-04')
        .addTo(controller);

    let scene10 = new ScrollMagic.Scene({
        offset: 8000,
        duration: 1000,
        triggerElement: "#overlay-text-wexford-04",
        triggerHook: 0.6,
    })
        //.addIndicators({ name: "--- overlay-text-wexford-02" })
        .setPin('#overlay-text-wexford-04')
        .addTo(controller);
</script>